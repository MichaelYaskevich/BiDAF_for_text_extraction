# BiDAF_for_text_extraction
В этой работе я решаю задачу выделения кусков текста, соответствующих теме, с помощью bert и BiDAF.

Постановка задачи:
Сделать модель, которая принимает на вход `текст документа` и одну из двух тем: `обеспечение исполнения контракта` или `обеспечение гарантийных обязательств`.
Модель должна возвращать `кусочек текста из текста документа, соответствующий теме` если такой есть, иначе пустую строку.

# Данные

### train.json 
Данные для обучения в формате json имеют следующие поля:
- `id`: int - id документа
-  `text`: str - текст документа, в котором может содержаться фрагмент текста, соответствующий теме из поля `label`
- `label`: str - одно из двух значений: `обеспечение исполнения контракта` или `обеспечение гарантийных обязательств`
- `extracted_part`: dict следующего формата:
    ```
    {
        'text': [фрагмент текста из поля `text`, соответствующий пункту анкеты], 
        'answer_start': [индекс символа начала фрагмента текста в тексте документа],
        'answer_end': [индекс символа конца фрагмента текста в тексте документа]
    }
   ```
### test.json
- `id`: int - id документа
-  `text`: str - текст документа, в котором может содержаться фрагмент текста, соответствующий теме из поля `label`
- `label`: str - одно из двух значений: `обеспечение исполнения контракта` или `обеспечение гарантийных обязательств`

Результат работы - test.json к которому добавлено поле extracted_part, аналогичное полю из train.json

# Решение
Использую `берт` в качестве экстрактора фичей и обрабатываю им все отрывки по теме `a`, чтобы получить суммарные фичи, которые содержат в себе информацию о том, как устроено предложение, соответствующее теме `a`. Аналогично получаю суммарные фичи для предложения темы `b`.

Затем рассматриваю эту задачу как `question answering` и использую модель `BiDAF`.

В модель подается `paragraph` и `query`.
- `paragraph` - текст, в котором нужно найти отрывок темы `a/b`
- `query` - суммарные фичи предложения темы `a/b`

На выходе модели получаю индексы токенов начала и конца фрагмента, затем от них перехожу к индексам символов исходного текста.

Для определения наличия искомого фрагмента текста я обучаю отдельный классификатор на основе BiDAF.

# Результаты
Accuracy 0.83 - доля наблюдений, в которых извлеченный моделью фрагмент текста полностью соответствует фактически требуемому фрагменту.
